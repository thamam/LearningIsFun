var cet;!function(e){!function(t){var n,a,l=[],r=null,i="inline",s=!1,u={horizontalMargins:0,verticalMargins:0};function c(){return!!r}function o(){"fullscreen"!=f()&&(a.fsapi.available(),a.fsapi.available()?a.fsapi.enter():a.fspoly.enter())}function d(){"inline"!=f()&&(a.fsapi.available()?a.fsapi.exit():a.fspoly.exit())}function f(e){return"fullscreen"===e&&o(),"inline"===e&&d(),i}function m(e){l.push(e)}function g(){for(var e=0;e<l.length;e++)l[e]()}!function(e){var t=[],n=[];e.callbacks={};var l=function(e,t,n){this.messageID=Math.random().toString(),this.key=t,this.value=n,this.type=e};function i(e,t){for(var n,l=[],i=2;i<arguments.length;i++)l[i-2]=arguments[i];var s=r||"unknown";if("parent"!=e){if(!(n=a.getIFrame(e)))return;s="parent"}var u="cet.display^"+s+"^"+t;l.length>0&&(u+="^"+JSON.stringify(l)),n?n.contentWindow.postMessage(u,"*"):window.parent.postMessage(u,"*")}function s(t,a,s){var u=new l("getValue",a);e.callbacks[u.messageID]=s,"parent"!=t||r?i(t,"valueexchange",u):n.push({target:t,method:"valueexchange",message:u})}function u(e,t,n){for(var a=o(e,t,n),l=0;l<a.length;l++)a[l](e,n)}function o(e,n,a,l){for(var r=[],i=0;i<t.length;i++){var s=t[i];s.type!=n&&("*"!=s.type||l)||"*"!=s.key&&s.key!=a.key||"*"!=s.source&&s.source!=e||r.push(s.handler)}return r}e.post=i,e.getValue=s,e.setValue=function(e,t,n){i(e,"valueexchange",new l("setValue",t,n))},e.publish=u,e.subscribe=function(e,n,a,l){t.push({type:n,key:a,handler:l,source:e})},e.emptyQueue=function(){for(var e=0;e<n.length;e++)i(n[e].target,n[e].method,n[e].message)},window.addEventListener("message",(function(t){if("string"==typeof t.data&&0==t.data.indexOf("cet.display")){t.data;var n=t.data.split("^"),r=n[1];switch(n[2].toLowerCase()){case"valueexchange":!function(t,n){if("getValue"==n.type){n.value=void 0;var a=o(t,"getreq",n,!0);if(a.length>0){var r=a[0](t,n);if(null==r&&c()){n.key;var d=t,f=n.messageID;return void s("parent",n.key,(function(e,t){var n=new l("getValueResult",e,t);n.messageID=f,i(d,"valueexchange",n)}))}JSON.stringify(r),n.value=r,n.type="getValueResult",i(t,"valueexchange",n)}}else if("setValue"==n.type)u(t,"set",n);else if("getValueResult"==n.type){if(u(t,"get",n),!(n.messageID in e.callbacks))return;e.callbacks[n.messageID](n.key,n.value),delete e.callbacks[n.messageID]}}(r,JSON.parse(n[3])[0]);break;case"hello":a.tryRegisterChildren()}}}),!1)}(n||(n={})),function(t){function a(){return parent!=self}function l(e){if(!e.attributes["data-cd-id"]){var t=Math.random();e.setAttribute("data-cd-id",t.toString())}var a=e.attributes["data-cd-id"].value;n.setValue(a,"id",a)}t.addHtmlClasses=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];document.documentElement.className+=" "+e.join(" ")},t.removeHtmlClasses=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=document.documentElement.className,a=0;a<e.length;a++)n=n.replace(e[a],"");n=n.replace(/  /gi,""),document.documentElement.className=n},t.hasParent=a,t.tryRegisterChildren=function(){if(document)for(var e=document.getElementsByTagName("iframe"),t=0;t<e.length;t++)if(e[t].attributes["data-cd-reg"]){var a=e[t].attributes["data-cd-id"].value;n.setValue(a,"id",a)}else l(e[t])},t.finalizeRegisterIFrame=function(e){e.setAttribute("data-cd-reg","true")},t.getIFrame=function(e){return document.querySelector('iframe[data-cd-id="'+e+'"]')},function(t){function n(){var e=navigator.userAgent;if(e.indexOf("Android")>-1&&e.indexOf("Chrome/27")>-1)return!1;if(e.indexOf("Safari")>-1&&e.indexOf("Macintosh")>-1&&e.indexOf("Version/6")>-1)return!1;if(null!=e.match(/.*Version\/([0-5]|(6\.0)).*Safari.*/gi))return!1;for(var t=["msFullscreenEnabled","mozFullScreenEnabled","fullScreenEnabled","fullscreenEnabled","webkitFullScreenEnabled","webkitFullscreenEnabled"],n=0;n<t.length;n++)if(null!=document[t[n]])return document[t[n]];return!1}function a(){return null!=document.msFullscreenElement||null!=document.fullscreenElement||null!=document.mozFullScreenElement||null!=document.webkitFullscreenElement||null!=document.webkitCurrentFullScreenElement}function l(t){a()?(document.body.style.width="100%",document.body.style.height="100%",i="fullscreen"):(void 0!==e.content&&void 0!==e.content.DisplayModes&&e.content.UI.displayMode(e.content.DisplayModes.INLINE),document.body.style.width="",document.body.style.height="",i="inline"),g()}t.available=n,t.enter=function(e){if(!n)throw Error("Cannot use fullscreen api when not available");if(!a()){var t=e&&e.element?e.element:document.body;t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.webkitRequestFullScreen?e&&e.requiresKeyboard?t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):t.webkitRequestFullScreen():t.requestFullScreen&&t.requestFullScreen()}},t.exit=function(){if(!n)throw Error("Cannot use fullscreen api when not available");if(a()){var e=document;e.msExitFullscreen?e.msExitFullscreen():e.cancelFullScreen?e.cancelFullScreen():e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.webkitCancelFullscreen&&e.webkitCancelFullscreen()}},t.isActive=a,document.addEventListener&&(document.addEventListener("fullscreenchange",l,!1),document.addEventListener("mozfullscreenchange",l,!1),document.addEventListener("webkitfullscreenchange",l,!1),document.addEventListener("MSFullscreenChange",l,!1))}(t.fsapi||(t.fsapi={})),function(e){function l(){a()&&null!=r?n.setValue("parent","requestdisplay","fullscreen"):(i="fullscreen",g())}function s(){a()&&null!=r?n.setValue("parent","requestdisplay","inline"):(i="inline",g())}function u(e,a){var r=t.getIFrame(e);if("fullscreen"==a)r.setAttribute("data-cd-style",r.style.cssText),r.setAttribute("data-cd-frameborder",r.frameBorder),r.style.cssText+="position:fixed;z-index:999999;top:0;left:0;margin:0;height:100%;width:100%;background-color:black;",navigator.userAgent.indexOf("iPad")>-1&&(r.style.cssText+="-webkit-transform: translate3d(0,0,0);"),r.frameBorder="0","fullscreen"!=i&&l();else{var u="",c=r.attributes["data-cd-style"];null!=c&&(u=c.value);var o=r.attributes["data-cd-frameborder"];null!=o&&(r.frameBorder=o.value),r.style.cssText=u,"inline"!=i&&s()}n.setValue(e,"displaychanged",a)}e.enter=l,e.exit=s,e.setMode=u,n.subscribe("*","set","requestdisplay",(function(e,t){u(e,t.value)})),n.subscribe("*","set","displaychanged",(function(e,t){i=t.value,g()}))}(t.fspoly||(t.fspoly={}))}(a||(a={})),t.fullscreen=o,t.inline=d,t.mode=f,t.childMode=function e(t,n){if(!t.attributes["data-cd-id"]||!t.attributes["data-cd-reg"]){t.attributes["data-cd-retries"]||t.setAttribute("data-cd-retries","0");var l=parseInt(t.attributes["data-cd-retries"].value)+1;if(l>50)return;return t.setAttribute("data-cd-retries",l.toString()),void setTimeout((function(){e(t,n)}),200)}t.removeAttribute("data-cd-retries"),a.fspoly.setMode(t.attributes["data-cd-id"].value,n)},t.change=m,t.getHostClientSize=function(e){n.getValue("parent","hostclientsize",(function(t,n){e(n)}))},t.setAsFixSizeHost=function(e){s=!0,e&&(u.horizontalMargins=e.horizontalMargins||0,u.verticalMargins=e.verticalMargins||0)},m((function(){var t=e.display.mode();a.removeHtmlClasses("cet-fullscreen","cet-inline"),a.addHtmlClasses("cet-"+t)})),a.addHtmlClasses("cet-"+f()),a.tryRegisterChildren(),n.subscribe("parent","set","id",(function(e,t){r=t.value,n.setValue("parent","readystate","ready"),n.emptyQueue()})),n.subscribe("*","getreq","hostclientsize",(function(e,t){if(!c()||s){var n=0,a=0;return"fullscreen"!=f()&&(n=u.horizontalMargins,a=u.verticalMargins),{width:document.documentElement.clientWidth-n,height:document.documentElement.clientHeight-a}}})),n.subscribe("*","set","readystate",(function(e,t){var n=a.getIFrame(e);n&&a.finalizeRegisterIFrame(n)})),a.hasParent()&&n.post("parent","hello")}(e.display||(e.display={}))}(cet||(cet={}));